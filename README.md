# מחלץ נתונים מדוחות כספיים

אפליקציה מבוססת-דפדפן המשתמשת בבינה מלאכותית (Google Gemini API) כדי לחלץ טבלאות נתונים מורכבות מדוחות כספיים בפורמט PDF ולהמיר אותן לפורמטים מובנים ושימושיים כמו JSON ו-CSV.

האפליקציה תומכת באופן מלא במסמכים בעברית ובפריסת טקסט מימין לשמאל (RTL).

## תכונות עיקריות

- **חילוץ מבוסס AI:** שימוש במודל `gemini-2.5-flash` של גוגל לזיהוי והבנה של מבני טבלאות מורכבים.
- **תהליך חילוץ דו-שלבי לאיכות מרבית:**
    1.  **שלב א - המרה ל-HTML:** המערכת ממירה תחילה את הטבלאות שזוהו ל-HTML סמנטי נקי.
    2.  **שלב ב - המרה לנתונים מובנים:** לאחר אישור המשתמש, ה-HTML מומר למבנה JSON מסודר על פי סכמה מוגדרת.
- **עיבוד מסמכים מלא:** האפליקציה סורקת את כל עמודי מסמך ה-PDF, לא רק עמוד בודד, ומאתרת את כל הטבלאות.
- **עיבוד מקבילי מהיר:** כל עמודי המסמך נשלחים לעיבוד במקביל כדי לקצר משמעותית את זמן ההמתנה.
- **ממשק משתמש אינטראקטיבי:** זרימת עבודה ברורה ומונחית, עם מחווני התקדמות בזמן אמת.
- **תמיכה מלאה בעברית ו-RTL:** הממשק כולו בעברית, והאפליקציה מותאמת באופן מלא לעבודה עם דוחות כספיים בעברית.
- **אפשרויות ייצוא מגוונות:** ניתן להוריד את הנתונים המובנים כקובץ JSON מלא או כקובץ CSV (בקידוד UTF-8 התואם לאקסל).

## איך משתמשים באפליקציה?

1.  **העלאת קובץ:** גרור קובץ PDF לאזור המיועד או לחץ כדי לבחור קובץ מהמחשב.
2.  **שלב 1 - חילוץ HTML:** המערכת תתחיל באופן אוטומטי לעבד את המסמך. סרגל התקדמות יציג את התהליך, עמוד אחר עמוד.
3.  **שלב 2 - אימות ותצוגה מקדימה:** בסיום העיבוד הראשוני, כל הטבלאות שחולצו יוצגו כתצוגת HTML. זהו שלב ביקורת המאפשר לך לוודא את איכות הזיהוי.
4.  **שלב 3 - המרה לנתונים מובנים:** לחץ על כפתור "**המר לנתונים מובנים**" כדי להתחיל את השלב הסופי.
5.  **שלב 4 - צפייה וייצוא:** התוצאות הסופיות יוצגו בממשק טאבים נוח. ניתן לעבור בין הטבלאות השונות, לצפות בנתונים הגולמיים או ב-JSON, ולהשתמש בכפתורי הייצוא כדי להוריד את המידע למחשב.

## טכנולוגיות בשימוש

- **Frontend:** React, TypeScript
- **AI / Machine Learning:** Google Gemini API (`gemini-2.5-flash`)
- **עיבוד PDF:** [PDF.js](https://mozilla.github.io/pdf.js/)
- **עיצוב ו-CSS:** Tailwind CSS
- **סביבת הרצה:** 100% בצד הלקוח (דפדפן). אין צורך בשרת ייעודי.

## איך זה עובד? (הסבר טכני)

האפליקציה משתמשת בתהליך חילוץ דו-שלבי חכם כדי להבטיח דיוק מירבי:

### שלב 1: מ-PDF ל-HTML

1.  האפליקציה טוענת את קובץ ה-PDF באמצעות ספריית `pdf.js`.
2.  עבור כל עמוד במסמך, היא מבצעת רינדור של העמוד לקנבס (canvas) וממירה אותו לתמונת JPEG בפורמט Base64.
3.  כל התמונות נשלחות **במקביל** ל-Gemini API באמצעות `Promise.allSettled`.
4.  ההנחיה (prompt) ל-API בשלב זה היא לזהות את כל הטבלאות בתמונה ולהמיר אותן למבנה HTML סמנטי (`<table>`, `<thead>`, `<tr>`, `<td>` וכו').

### שלב 2: מ-HTML ל-JSON מובנה

1.  לאחר שהמשתמש מאמת את תקינות ה-HTML, כל מקטעי ה-HTML שנאספו נשלחים יחד בבקשה אחת ל-Gemini API.
2.  בשלב זה, ההנחיה היא שונה: לנתח את ה-HTML הנתון, להבין את ההקשר של כל טבלה, ולבנות אובייקט JSON יחיד התואם לסכמה (Schema) שהוגדרה מראש.
3.  הסכמה דורשת מהמודל לזהות מטא-דאטה כללי (כמו מטבע ותקופת דיווח) ולהפיק מערך של טבלאות, כאשר כל טבלה מכילה כותרת, עמודות, נתונים גולמיים (2D array) ואת מספר העמוד המקורי.

הפרדה זו בין זיהוי המבנה הוויזואלי (שלב 1) לבין הניתוח הסמנטי (שלב 2) מאפשרת גמישות ודיוק גבוהים יותר באופן משמעותי.
